<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<HTML>
<HEAD>
<TITLE>GSM Authentication & Encryption</TITLE>

<META name="keywords" content="GSM, authentication, ciphering, Ki, RAND, A3, algorithm, A8, A5, Kc, SRES, triplets, IMSI">

<META name="description" content="A tutorial about authentication and encryption in GSM">

</HEAD>

<BODY>



<br><br>
<a name = "top">

<center>

<h1>Authentication & Encryption</h1>

<font size = "2">

<a href = "../encryption/encryption.shtml#intro">Introduction</a>
&nbsp;&nbsp;&nbsp;

<a href = "../encryption/encryption.shtml#authproc">Authentication Procedures</a>
&nbsp;&nbsp;&nbsp;

<a href = "../encryption/encryption.shtml#cipherproc">Ciphering Procedures</a>
&nbsp;&nbsp;&nbsp;

</font>



<br><br>
<a href = "http://www.gsmfordummies.com/index.html">Home</a>

<hr width=100% size=5 noshade>
<br><br>

</center>

<a name = "intro"></a><h2>Introduction</h2>
<p><b>Authentication</b> - Whenever a MS requests access to a network, the network must authenticate the MS. Authentication verifies the identity and validity of the SIM card to the network and ensures that the subscriber is authorized access to the network. <br><br>
  <b>Encryption</b> - In GSM, encryption refers to the process of creating authentication and ciphering crypto-variables using a special key and an encryption algorithm.<br><br>
  <b>Ciphering</b> - Ciphering refers to the process of changing plaintext data into encrypted data using a special key and a special encryption algorithm. Transmissions between the MS and the BTS on the Um link are enciphered.<br><br>
  <b>Ki</b> - The Ki is the individual subscriber authentication key. It is a 128-bit number that is paired with an IMSI when the SIM card is created. The Ki is only stored on the SIM card and at the Authentication Center (AuC). The Ki will never be transmitted across the network on any link.<br><br>
  <b>RAND</b> - The RAND is a random 128-bit number that is generated by the AuC when the network requests to authenticate a subscriber. The RAND is used to generate the Signed Response (SRES) and Kc crypto-variables.<br><br>
<b>Signed Response</b> - The SRES is a 32-bit crypto-variable used in the authentication process. The MS is challenged by being given the RAND by the network, the SRES is the expected correct response. The MS receives the RAND as a challenge and uses it to calculate the SRES. The SRES is passed up to the network to as a response to the challenge. </p>
<p>
  <b>A3 Algorithm</b> - The A3 algorithm computes a 32-bit Signed Response (SRES). The Ki and RAND are inputted into the A3 algorithm and the result is the 32-bit SRES. The A3 algorithm resides on the SIM card and at the AuC.<br><br>
  <b>A8 Algorithm</b> - The A8 algorithm computes a 64-bit ciphering key (Kc). The Ki and the RAND are inputted into the A8 algorithm and the result is the 64-bit Kc. The A8 algorithm resides on the ISM card and at the AuC.</p>
<p><strong>COMP128</strong> - A keyed hash function that combines the A3 and A8 algorithms into a single function. The 128-bit Ki and 128-bit RAND are input into the COMP128 which generates a 32-bit SRES and a 54-bit Kc in a single function. COMP128 is weak because it can give away information about the Ki. <br>
  <br>
  <b>Kc</b> - The Kc is the 64-bit ciphering key that is used in the A5 encryption algorithm to encipher and decipher the data that is being transmitted on the Um interface.<br><br>
  <b>A5</b> - The A5 encryption algorithm is used to encipher and decipher the data that is being transmitted on the Um interface. The Kc and the plaintext data are inputted into the A5 algorithm and the output is enciphered data. The A5 algorithm is a function of the Mobile Equipment (ME) and not a function of the SIM card. The BTS also makes use of the A5 algorithm.<br><br>There are three versions of the A5 algorithm:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A5/1 - The current standard for U.S. and European networks. A5/1 is a stream cipher.<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A5/2 - The deliberately weakened version of A5/1 that is intended for export to non-western countries. A5/2 is a stream cipher.<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A5/3 - A newly developed algorithm not yet in full use. A5/3 is a block cipher.<br><br>
  <b>Triplets</b> - The RAND, SRES, and Kc together are known as the Triplets. The AuC will send these three crypto-variables to the requesting MSC/VLR so it can authenticate and encipher.
  
  <br><br>
  
  <font size = "2"> <a href = "#top">[Back to Top]</a></font>
  
  <br>
</p>
<hr width=100%>
<br>


<a name="authproc"></a><center><h2>Authentication Procedures</h2></center><table border = "0" cellspacing = "50"><tr>
    <td><p>When a MS requests access to the network, the MSC/VLR will normally require the MS to <i>authenticate</i>. The MSC will forward the IMSI to the HLR and request authentication <i>Triplets</i>.  </p>
    <p>The network can have the MS authenticate whenever it wants and this can vary from network to network. The network can require the MS to authenticate every time an event is initiated (location update, mobile-originated call, mobile-terminated call, etc.), every so many events, or even after a certain time period has elapsed. The network will almost always require authentication whenever the MS moves into a new Location Area and does a <a href="../gsmevents/location_update.shtml" target="locup">Location Update</a>.</p></td><td><img src = "images/enc1.gif">  </td><tr><tr><td>When the HLR receives the IMSI and the authentication request, it first checks its database to make sure the IMSI is valid and belongs to the network. Once it has accomplished this, it will forward the IMSI and authentication request to the <i>Authentication Center</i> (AuC).  </td><td><img src = "images/enc2.gif">  </td><tr><tr><td>The AuC will use the IMSI to look up the Ki associated with that IMSI. The Ki is the individual subscriber authentication key. It is a 128-bit number that is paired with an IMSI when the SIM card is created. <strong>The Ki is only stored on the SIM card and at the AuC.</strong> The Auc will also generate a 128-bit random number called the RAND. </td><td><center><img src = "images/enc4.gif"></center></td><tr><tr><td>The RAND and the Ki are inputted into the A3 encryption algorithm. The output is the 32-bit <i>Signed Response</i> (SRES). The SRES is essentially the "challenge" sent to the MS when authentication is requested.  </td><td><center><img src = "images/enc5.gif">  </center></td><tr><tr><td>The RAND and Ki are input into the A8 encryption algorithm. The output is the 64-bit Kc.  The Kc is the ciphering key that is used in the A5 encryption algorithm to encipher and decipher the data that is being transmitted on the Um interface.    </td><td><center><img src = "images/enc6.gif"></center>  </td><tr><tr>
      <td>The RAND, SRES, and Kc are collectively known as the <i>Triplets</i>. The AuC may generate many sets of Triplets and send them to the requesting MSC/VLR. This is in order to reduce the signaling overhead that would result if the MSC/VLR requested one set of triplets every time it wanted to authenticate the MS. It should be noted that a set of triplets is unique to one IMSI, it can not be used with any other IMSI.  </td><td><center><img src = "images/enc7.gif"></center>  </td><tr><tr>
      <td>Once the AuC has generated the triplets (or sets of triplets), it forwards them to the HLR. The HLR subsequently sends them to the requesting MSC/VLR.   </td><td><center><img src = "images/enc8.gif"></center>  </td><tr><tr><td>The MSC stores the Kc and the SRES but forwards the RAND to the MS and orders it to authenticate.   </td><td><img src = "images/enc9.gif">  </td><tr><tr><td>The MS has the Ki stored on the SIM card. The A3 and A8 algorithms also reside on the SIM card. The RAND and Ki are inputted into the A3 and A8 encryption algorithms to generate the SRES and the Kc respectively.  </td><td><center><img src = "images/enc10.gif"> </center> </td><tr></table>

<br><br>

<font size = "2"> <a href = "#top">[Back to Top]</a></font>

<br>
<hr width=100%>
<br>


<a name="cipherproc"></a><br><center><h2>Ciphering Procedure</h2></center><br><table border = "0" cellspacing = "50"><tr>
    <td>The MS stores the Kc on the SIM card and sends the generated SRES back to the network. The MSC receives the MS generated SRES and compares it to the SRES generated by the AuC. If they match, then the MS is authenticated.  </td><td><img src = "images/enc11.gif">  </td><tr><tr>
      <td>Once the MS is authenticated, the MSC passes the Kc to the BSS (the BTS to be specific), and orders the BTS and MS to switch to <i>Cipher Mode</i>. The Kc will never be passed on the Air Interface (Um), it will be stored at the BTS.  </td><td><center><img src = "images/enc12.gif"> </center> </td><tr><tr><td>The BTS inputs the Kc and the data payload into the A5 encryption algorithm resulting in an enciphered data stream. The MS also inputs the Kc and the data payload into the A5 encryption algorithm resulting in an enciphered data stream. It should be noted that the A5 algorithm is a function of the Mobile Equipment (ME) and not the SIM card.</td><td><img src = "images/enc13.gif">  </td><tr></table>
<p><br>

<br>
  
  <font size = "2"> <a href = "#top">[Back to Top]</a></font>
  
  <br>
</p>
<hr width=100%>
  <br>
<a name="comp128"></a><br><center>
  <h2>COMP128</h2></center>
  
  <p>COMP128 is a single keyed hash function that takes the place of the A3 and A8 algorithms and generates the SRES and Kc in a single function. The Ki and RAND are fed into the COMP128 hash and the result is a 32-bit SRES and a<strong><em> 54-bit Kc</em></strong>. Note that the A8 algorithm generates a <strong>64-bit Kc</strong>. So it is obvious that the COMP128 hash generates a much weaker Kc. </p>
  <p><center><img src="images/enc14.gif"></center></p>
  <center>
  
  <hr width=100% size=5 noshade>

<font size = "2">

<a href = "../encryption/encryption.shtml#intro">Introduction</a>
&nbsp;&nbsp;&nbsp;

<a href = "../encryption/encryption.shtml#authproc">Authentication Procedures</a>
&nbsp;&nbsp;&nbsp;

<a href = "../encryption/encryption.shtml#cipherproc">Ciphering Procedures</a>
&nbsp;&nbsp;&nbsp;

</font>



<br><br>

<font size = "2">

<a href = "../intro/intro.shtml">Introduction</a>
&nbsp;&nbsp;&nbsp;

<a href = "../architecture/arch.shtml">Architecture</a>
&nbsp;&nbsp;&nbsp;

<a href = "../tdma/tdma.shtml">TDMA</a>
&nbsp;&nbsp;&nbsp;

<a href = "../tdma/logical.shtml">Logical Channels</a>
&nbsp;&nbsp;&nbsp;

<a href = "../encryption/encryption.shtml">Authentication & Encryption</a>
&nbsp;&nbsp;&nbsp;

<a href = "../timing/timing.shtml">Timing Advances</a>
&nbsp;&nbsp;&nbsp;

<a href = "../encoding/encoding.shtml">Speech Encoding</a>
&nbsp;&nbsp;&nbsp;

<a href = "../gsmevents/events.shtml">GSM Events</a>
&nbsp;&nbsp;&nbsp;

<a href = "../air/radiolink.shtml">Cell Selection/Reselection</a>

<br>

<a href = "../updates.shtml">Updates</a>
&nbsp;&nbsp;&nbsp;

<!--<a href = "../forum/index.php" target = "BB">Bulletin Board</a>
&nbsp;&nbsp;&nbsp;-->

<a href = "../sitemap.shtml">Sitemap</a>
&nbsp;&nbsp;&nbsp;

<a href = "../contact/contact.shtml">Contact Me</a>






</font>

<br><br>
<a href = "http://www.gsmfordummies.com/index.html">Home</a>

</center>



<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-6152103-1");
pageTracker._trackPageview();
</script>

</BODY></HTML>