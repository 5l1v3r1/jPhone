<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<HTML><HEAD><TITLE>IMSI Attach</TITLE>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-20814942-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</HEAD>


<BODY>

<center>

<h1>GSM Events</h1>

<font size = "2">

<a href = "../gsmevents/attach.shtml">IMSI Attach</a>
&nbsp;&nbsp;&nbsp;

<a href = "../gsmevents/detach.shtml">IMSI Detach</a>
&nbsp;&nbsp;&nbsp;

<a href = "../gsmevents/location_update.shtml">Location Update</a>
&nbsp;&nbsp;&nbsp;

<a href = "../gsmevents/mobile_originated.shtml">Mobile-Originated Call</a>
&nbsp;&nbsp;&nbsp;

<a href = "../gsmevents/mobile_terminated.shtml">Mobile-Terminated Call</a>
&nbsp;&nbsp;&nbsp;


</font>


<br><br>

<a href = "http://www.gsmfordummies.com/index.html">Home</a>


<hr width=100% size=5 noshade>
<br><br>

</center>



<center><h1>IMSI Attach</h1></center><h3>A MS performs an IMSI Attach any time it comes onto a network. If a phone is just powering up, it will contact the network and perform an IMSI Attach, letting the network know where the MS is. </h3><br><br>For the purposes of these diagrams, the BTS and BSC are shown together as the BSS and their functions are considered one. The MSC and VLR are also shown as one entity and will be treated as one network component, unless otherwise specified.<br><br><table border = "0" cellspacing = "10"><tr><td colspan = "2" bgcolor = "gray"></td></tr><tr><td colspan = "2"><h1><center>Channel Request</center></h1></td></tr><tr border = "1">	<td align = "left">		1. The MS will send a <i>Channel Request (CHAN_REQ)</i> message to the BSS on the RACH.	<BR><BR>		2. The BSS responds on the AGCH with an <i>Immediate Assignment (IMM_ASS_CMD)</i> message and assigns an SDCCH to the MS. 	<BR><BR>		3. The MS immediately switches to the assigned SDCCH and sends a <i>Location Update Request (LOC_UPD_REQ)</i> to the BSS. The MS will send either an IMSI or a TMSI to the BSS.	<BR><BR>		4. The BSS will acknowledge the message. This acknowledgement only tells the MS that the BTS has received the message, it does not indicate the location update has been processed.	</td>	<td bgcolor = "gray"><center><img src = "images/IMSI Attach 1.gif"></center></td></tr><tr><td colspan = "2" bgcolor = "gray"></td></tr><tr><td colspan = "2"><h1><center>IMSI Verification / Request Triplets</center></h1></td></tr><tr>	<td>		5. The BSS forwards the Location Update Request to the MSC/VLR.  	<br><br>		6. The MSC/VLR forwards the IMSI to the HLR and requests verification of the IMSI as well as Authentication <i>Triplets</i>.	<br><br>		7. The HLR will forward the IMSI to the Authentication Center (AuC) and request authentication triplets.	<br><br>		8. The AuC generates the triplets and sends them along with the IMSI, back to the HLR.	<br><br>		9. The HLR validates the IMSI by ensuring it is allowed on the network and is allowed subscriber services. It then forwards the IMSI and Triplets to the MSC/VLR.	<br><br>		</td>	<td bgcolor = "gray"><center><img src = "images/IMSI Attach 2.gif"></center>  </td></tr><tr><td colspan = "2" bgcolor = "gray"></td></tr><tr><td colspan = "2"><h1><center>Authentication</center></h1></td></tr><tr>	<td>	10. The MSC/VLR stores the SRES and the Kc and forwards the RAND to the BSS and orders the BSS to authenticate the MS. 	<br><br>	11. The BSS sends the MS an <i>Authentication Request (AUTH_REQ)</i> message to the MS. The only parameter sent in the message is the RAND.	<br><br>	12. The MS uses the RAND to calculate the SRES and sends the SRES back to the BSS on the SDCCH in an <i>Authentication Response (AUTH_RSP)</i>. The BSS forwards the SRES up to the MSC/VLR.	<br><br>	13. The MSC/VLR compares the SRES generated by the AuC with the SRES generated by the MS. If they match, then authentication is completed successfully.	<br><br>	<font size = "2">*For a more in-depth discussion of authentication and encryption, view the <a href="../encryption/encryption.html" target = "encryption">Authentication and Encryption Tutorial</a>.</font></td>	<td bgcolor = "gray"><center><img src = "images/IMSI Attach 3.gif"></center>  </td></tr><tr><td colspan = "2" bgcolor = "gray"></td></tr><tr><td colspan = "2"><h1><center>Encryption</center></h1></td></tr><tr>	<td>	14. The MSC/VLR forwards the Kc for the MS to the BSS. The Kc is NOT sent across the Air Interface to the MS. The BSS stores the Kc and forwards the <i>Set Cipher Mode (CIPH_MOD_CMD)</i> command to the MS. The CIPH_MOD_CMD only tells the MS which encryption to use (A5/X), no other information is included.	<br><br>	15. The MS immediately switches to cipher mode using the A5 encryption algorithm. All transmissions are now enciphered. It sends a <i>Ciphering Mode Complete (CIPH_MOD_COM)</i> message to the BSS.	<br><br>	16. The MSC/VLR sends a <i>Location Updating Accept (LOC_UPD_ACC)</i> message to the BSS. It also generates a new TMSI for the MS. TMSI assignment is a function of the VLR. The BSS will either send the TMSI in the LOC_UPD_ACC message or it will send a separate <i>TMSI Reallocation Command message (TMSI_REAL_CMD)</i>. In both cases, since the Air Interface  is now in cipher mode, the TMSI is not compromised.	 </td>	<td bgcolor = "gray"><center><img src = "images/IMSI Attach 4.gif"></center>  </td></tr><tr><td colspan = "2" bgcolor = "gray"></td></tr><tr><td colspan = "2"><h1><center>Location Update</center></h1></td></tr><tr>	<td>	17. The MS sends a <i>TMSI Reallocation Complete message (TMSI_REAL_COM)</i> up to the MSC/VLR.<br><br>	18. The BSS instructs the MS to go into idle mode by sending it a <i>Channel Release (CHAN_REL)</i> message. The BSS then deassigns the SDCCH.<br><br>	19. The MSC/VLR sends an <i>Update Location</i> message to the HLR. The HLR records which MSC/VLR the MS is currently in, so it knows which MSC to point to when it is queried for the location of the MS.	</td>	<td bgcolor = "gray"><center><img src = "images/IMSI Attach 5.gif"></center>
</td></table>

<br><br>

<center>
<br>

<hr width=100% size=5 noshade>

<font size = "2">

<a href = "../gsmevents/attach.shtml">IMSI Attach</a>
&nbsp;&nbsp;&nbsp;

<a href = "../gsmevents/detach.shtml">IMSI Detach</a>
&nbsp;&nbsp;&nbsp;

<a href = "../gsmevents/location_update.shtml">Location Update</a>
&nbsp;&nbsp;&nbsp;

<a href = "../gsmevents/mobile_originated.shtml">Mobile-Originated Call</a>
&nbsp;&nbsp;&nbsp;

<a href = "../gsmevents/mobile_terminated.shtml">Mobile-Terminated Call</a>
&nbsp;&nbsp;&nbsp;


</font>


<br><br>

<font size = "2">

<a href = "../intro/intro.shtml">Introduction</a>
&nbsp;&nbsp;&nbsp;

<a href = "../architecture/arch.shtml">Architecture</a>
&nbsp;&nbsp;&nbsp;

<a href = "../tdma/tdma.shtml">TDMA</a>
&nbsp;&nbsp;&nbsp;

<a href = "../tdma/logical.shtml">Logical Channels</a>
&nbsp;&nbsp;&nbsp;

<a href = "../encryption/encryption.shtml">Authentication & Encryption</a>
&nbsp;&nbsp;&nbsp;

<a href = "../timing/timing.shtml">Timing Advances</a>
&nbsp;&nbsp;&nbsp;

<a href = "../encoding/encoding.shtml">Speech Encoding</a>
&nbsp;&nbsp;&nbsp;

<a href = "../gsmevents/events.shtml">GSM Events</a>
&nbsp;&nbsp;&nbsp;

<a href = "../air/radiolink.shtml">Cell Selection/Reselection</a>

<br>

<a href = "../updates.shtml">Updates</a>
&nbsp;&nbsp;&nbsp;

<!--<a href = "../forum/index.php" target = "BB">Bulletin Board</a>
&nbsp;&nbsp;&nbsp;-->

<a href = "../sitemap.shtml">Sitemap</a>
&nbsp;&nbsp;&nbsp;

<a href = "../contact/contact.shtml">Contact Me</a>






</font>

<br><br>

<a href = "http://www.gsmfordummies.com/index.html">Home</a>


</center>



<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-6152103-1");
pageTracker._trackPageview();
</script>

</BODY></HTML>